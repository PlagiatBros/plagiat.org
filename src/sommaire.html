#SET{description,#DESCRIPTIF_SITE_SPIP|textebrut}
#SET{image,#LOGO_SITE_SPIP|image_reduire{640}|image_recadre{16:9,'-'}|extraire_attribut{src}|url_absolue}
#SET{page_url,#URL_SITE_SPIP|url_absolue}

<!DOCTYPE html>
<html lang="#LANG"[ class="(#HTML_CLASS|match{epk})"]>
<head>
    <meta charset="utf-8"/>
    <title>[(#NOM_SITE_SPIP|textebrut)] - [(#SLOGAN_SITE_SPIP|textebrut)]</title>
    <link rel="shortcut icon" href="#CHEMIN{favicon.png}" />
    <link rel="canonical" href="#GET{page_url}" />
    <meta name="description" content="[(#DESCRIPTIF_SITE_SPIP|textebrut)]" />
    <meta property="og:image" content="[(#LOGO_SITE_SPIP|image_recadre{'19:10', '+', 'center top', #ffffff}|extraire_attribut{src}|supprimer_timestamp|url_absolue)]"/>
    #SET{css, #INCLURE{styles.css}|minify|replace{\$bg, #LOGO_SITE_SPIP|image_reduire{640, 0}|extraire_attribut{src}}}
    <style>
        /* src: #CHEMIN{styles.css} */
        #GET{css}
    </style>
</head>
<body>

<BOUCLE_rubrique(RUBRIQUES){par num titre}{0, 1}{tout}>

<div class="nav">
    <ul>
        <li><a href="#">[plaʒia]</a></li>
    <BOUCLE_nav(ARTICLES){id_rubrique}{par num titre}{1,10}>
        <li><a href="#[(#TITRE|textebrut|replace{' ',''})]">[(#TITRE|textebrut)]</a></li>
    </BOUCLE_nav>
    </ul>
</div>

<h1>#TITRE</h1>

<BOUCLE_articles(ARTICLES){id_rubrique}{par num titre}>

<h2><a class="anchor" data-anchor="[(#COMPTEUR_BOUCLE|moins{1})]" id="[(#TITRE|textebrut|replace{' ',''})]"></a>#TITRE</h2>

#TEXTE

</BOUCLE_articles>

</BOUCLE_rubrique>

<script>

    // remove hash when it's empty
    window.onhashchange = function(){
        if (location.hash === '') {
            history.replaceState('', document.title, location.pathname + location.search);
        }
    }

    // display current section
    var navitems = document.querySelectorAll('.nav li a'),
        anchors = document.querySelectorAll('.anchor'),
        debounce

    function checkScroll() {
        var nearest, bestScore = Infinity

        anchors.forEach(function(a, i){
            var y = a.getClientRects()[0].y,
                score = Math.abs(y)
            if (score <= bestScore && y -window.innerHeight < 0) {
                bestScore = score
                nearest = a
            }
        })

        navitems.forEach(function(a, i){
            a.classList.toggle('on', nearest && nearest.getAttribute('data-anchor') == i)
        })
    }

    window.onscroll = checkScroll

    document.addEventListener('DOMContentLoaded', checkScroll)

</script>
</body>
</html>
